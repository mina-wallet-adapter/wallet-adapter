var I=Object.create,k=Object.defineProperty,L=Object.getOwnPropertyDescriptor,N=Object.getOwnPropertyNames,j=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty,K=(t,e)=>function(){return e||(0,t[N(t)[0]])((e={exports:{}}).exports,e),e.exports},Q=(t,e,u,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let h of N(e))!D.call(t,h)&&h!==u&&k(t,h,{get:()=>e[h],enumerable:!(a=L(e,h))||a.enumerable});return t},U=(t,e,u)=>(u=t!=null?I(j(t)):{},Q(e||!t||!t.__esModule?k(u,"default",{value:t,enumerable:!0}):u,t)),V=K({"../../../../node_modules/eventemitter3/index.js"(t,e){var u=Object.prototype.hasOwnProperty,a="~";function h(){}Object.create&&(h.prototype=Object.create(null),new h().__proto__||(a=!1));function v(o,r,s){this.fn=o,this.context=r,this.once=s||!1}function _(o,r,s,i,f){if(typeof s!="function")throw new TypeError("The listener must be a function");var p=new v(s,i||o,f),c=a?a+r:r;return o._events[c]?o._events[c].fn?o._events[c]=[o._events[c],p]:o._events[c].push(p):(o._events[c]=p,o._eventsCount++),o}function S(o,r){--o._eventsCount===0?o._events=new h:delete o._events[r]}function d(){this._events=new h,this._eventsCount=0}d.prototype.eventNames=function(){var r=[],s,i;if(this._eventsCount===0)return r;for(i in s=this._events)u.call(s,i)&&r.push(a?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(s)):r},d.prototype.listeners=function(r){var s=a?a+r:r,i=this._events[s];if(!i)return[];if(i.fn)return[i.fn];for(var f=0,p=i.length,c=new Array(p);f<p;f++)c[f]=i[f].fn;return c},d.prototype.listenerCount=function(r){var s=a?a+r:r,i=this._events[s];return i?i.fn?1:i.length:0},d.prototype.emit=function(r,s,i,f,p,c){var y=a?a+r:r;if(!this._events[y])return!1;var n=this._events[y],m=arguments.length,g,l;if(n.fn){switch(n.once&&this.removeListener(r,n.fn,void 0,!0),m){case 1:return n.fn.call(n.context),!0;case 2:return n.fn.call(n.context,s),!0;case 3:return n.fn.call(n.context,s,i),!0;case 4:return n.fn.call(n.context,s,i,f),!0;case 5:return n.fn.call(n.context,s,i,f,p),!0;case 6:return n.fn.call(n.context,s,i,f,p,c),!0}for(l=1,g=new Array(m-1);l<m;l++)g[l-1]=arguments[l];n.fn.apply(n.context,g)}else{var T=n.length,A;for(l=0;l<T;l++)switch(n[l].once&&this.removeListener(r,n[l].fn,void 0,!0),m){case 1:n[l].fn.call(n[l].context);break;case 2:n[l].fn.call(n[l].context,s);break;case 3:n[l].fn.call(n[l].context,s,i);break;case 4:n[l].fn.call(n[l].context,s,i,f);break;default:if(!g)for(A=1,g=new Array(m-1);A<m;A++)g[A-1]=arguments[A];n[l].fn.apply(n[l].context,g)}}return!0},d.prototype.on=function(r,s,i){return _(this,r,s,i,!1)},d.prototype.once=function(r,s,i){return _(this,r,s,i,!0)},d.prototype.removeListener=function(r,s,i,f){var p=a?a+r:r;if(!this._events[p])return this;if(!s)return S(this,p),this;var c=this._events[p];if(c.fn)c.fn===s&&(!f||c.once)&&(!i||c.context===i)&&S(this,p);else{for(var y=0,n=[],m=c.length;y<m;y++)(c[y].fn!==s||f&&!c[y].once||i&&c[y].context!==i)&&n.push(c[y]);n.length?this._events[p]=n.length===1?n[0]:n:S(this,p)}return this},d.prototype.removeAllListeners=function(r){var s;return r?(s=a?a+r:r,this._events[s]&&S(this,s)):(this._events=new h,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=a,d.EventEmitter=d,typeof e<"u"&&(e.exports=d)}}),O="mina:mainnet",P="mina:devnet",C="mina:berkeley",H=[O,P,C],z=U(V(),1),R=z.default,x={Mainnet:O,Devnet:P,Berkeley:C},w=(t=>(t.Installed="Installed",t.NotDetected="NotDetected",t.Loadable="Loadable",t.Unsupported="Unsupported",t))(w||{}),F=class extends R{get connected(){return!!this.account}get publicKey(){return this.account?this.account.address:null}get chain(){return null}async autoConnect(){await this.connect()}scopePollingDetectionStrategy(t){if(typeof window>"u"||typeof document>"u")return;const e=[];function u(){if(t())for(const v of e)v()}const a=setInterval(u,1e3);e.push(()=>clearInterval(a)),document.readyState==="loading"&&(document.addEventListener("DOMContentLoaded",u,{once:!0}),e.push(()=>document.removeEventListener("DOMContentLoaded",u))),document.readyState!=="complete"&&(window.addEventListener("load",u,{once:!0}),e.push(()=>window.removeEventListener("load",u))),u()}},b=class extends Error{constructor(t,e){super(t),this.error=e}},W=class extends b{constructor(){super(...arguments),this.name="WalletNotReadyError"}},q=class extends b{constructor(){super(...arguments),this.name="WalletNotConnectedError"}},J=class extends b{constructor(){super(...arguments),this.name="WalletSignAndSendTransactionError"}},E=class extends b{constructor(){super(...arguments),this.name="WalletNotSupportedMethodError"}},X="MetaMask Snap",M="npm:mina-portal",Y=class extends F{constructor(t={}){super(),this.name=X,this.url="https://snaps.metamask.io/snap/npm/mina-portal/",this.icon="data:image/png;base64,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",this._listenerAdded=!1,this._readyState=typeof window>"u"||typeof document>"u"?w.Unsupported:w.NotDetected,this.detectMetamaskSnap=()=>{const e=this;if(e._readyState===w.Installed)return!0;function u(v){e._provider||(e._provider=v,e._readyState=w.Installed,e.emit("readyStateChange",e._readyState),window.removeEventListener("eip6963:announceProvider",h))}function a(){window.removeEventListener("ethereum#initialized",a);const{ethereum:v}=window;v&&v.isMetaMask&&u(v)}function h(v){const{provider:_}=v.detail;_&&_.isMetaMask&&u(_)}return window.ethereum?a():e._listenerAdded||(window.addEventListener("ethereum#initialized",a),setTimeout(a,3e3)),e._listenerAdded||window.addEventListener("eip6963:announceProvider",h),window.dispatchEvent(new Event("eip6963:requestProvider")),e._listenerAdded=!0,!1},this._connecting=!1,this._publicKey=null,this._account=null,this._provider=null,this._readyState!==w.Unsupported&&this.scopePollingDetectionStrategy(this.detectMetamaskSnap)}get account(){return this._account}get connecting(){return this._connecting}get connected(){return!!this._publicKey}get readyState(){return this._readyState}get chain(){return this._chain}set chain(t){if(t){const e=t===x.Mainnet?"Mainnet":t===x.Berkeley?"Berkeley":"Devnet";this.invokeSnapMethod("mina_changeNetwork",{networkName:e}).then(()=>this.getChain())}else this._chain=null}async getChain(){const{name:t}=await this.invokeSnapMethod("mina_networkConfig");this._chain=t==="Mainnet"?x.Mainnet:t==="Berkeley"?x.Berkeley:x.Devnet,this.emit("chainChange",this._chain)}async isSnapConnected(){await this._provider?.request({method:"wallet_requestSnaps",params:{[M]:{}}});const t=await this._provider?.request({method:"wallet_getSnaps"});return Object.keys(t).includes(M)}async invokeSnapMethod(t,e){if(!this._provider)throw new q;return await this._provider?.request({method:"wallet_invokeSnap",params:{snapId:M,request:{method:t,params:e}}})}async connect(){try{if(this.connected||this.connecting)return;if(this._readyState!==w.Installed)throw new W;if(await this.isSnapConnected()){await this.getChain();const t=await this.invokeSnapMethod("mina_accountList"),e=t&&t[0]?.address||null;e&&(this._publicKey=e,this._account={address:e,publicKey:new Uint8Array,chains:H,features:[]},this.emit("connect",this._account))}}catch(t){throw this.emit("error",t),t}finally{this._connecting=!1}}async disconnect(){this._publicKey=null,this._account=null,this.emit("disconnect")}async signMessage(t){try{return await this.invokeSnapMethod("mina_signMessage",{message:t})}catch(e){throw this.emit("error",e),e}}async signTransaction(t){throw new E("'signTransaction' is not supported. Use 'signAndSendTransaction' instead.")}async sendTransaction(t){throw new E("'sendTransaction' is not supported. Use 'signAndSendTransaction' instead.")}async signAndSendTransaction(t){try{if(typeof t=="string")throw new J("'transaction' parameter cannot be a string");const e=t.hasOwnProperty("amount")?"mina_sendPayment":"mina_sendStakeDelegation",{hash:u}=await this.invokeSnapMethod(e,t);return u}catch(e){throw this.emit("error",e),e}}};export{Y as MetaMaskSnapWalletAdapter,X as MetaMaskSnapWalletName};
